{"version":3,"file":"portal-vue.umd.js","sources":["../src/utils/index.ts","../src/components/wormhole.ts","../src/components/portal.tsx","../src/components/portal-target.tsx","../src/components/mounting-portal.tsx","../src/index.ts"],"sourcesContent":["import { VNode } from 'vue'\nimport { Transport } from '../types'\n\nexport function freeze<R>(item: R[]): ReadonlyArray<R> {\n  if (Array.isArray(item) || typeof item === 'object') {\n    return Object.freeze(item)\n  }\n  return item\n}\n\nexport function combinePassengers(\n  transports: Transport[],\n  slotProps = {}\n): Array<VNode> {\n  return transports.reduce(\n    (passengers, transport) => {\n      const temp = transport.passengers[0]\n      const newPassengers =\n        typeof temp === 'function'\n          ? (temp(slotProps) as VNode[])\n          : (transport.passengers as VNode[])\n      return passengers.concat(newPassengers)\n    },\n    [] as Array<VNode>\n  )\n}\n\nexport function stableSort<T>(array: T[], compareFn: Function) {\n  return array\n    .map((v: T, idx: number) => {\n      return [idx, v] as [number, T]\n    })\n    .sort(function(a, b) {\n      return compareFn(a[1], b[1]) || a[0] - b[0]\n    })\n    .map(c => c[1])\n}\n\nexport function pick<T extends object, K extends keyof T>(\n  obj: T,\n  keys: K[]\n): Pick<T, K> {\n  return keys.reduce(\n    (acc, key) => {\n      if (obj.hasOwnProperty(key)) {\n        acc[key] = obj[key]\n      }\n      return acc\n    },\n    {} as Pick<T, K>\n  )\n}\n","import Vue from 'vue'\nimport { freeze, stableSort } from '../utils'\nimport {\n  Transports,\n  Transport,\n  TransportInput,\n  TransportVector,\n  VMRegister,\n} from '@/types'\n\nconst transports: Transports = {}\nconst targets: VMRegister = {}\nconst sources: VMRegister = {}\n\nexport const Wormhole = Vue.extend({\n  data: () => ({\n    transports,\n    targets,\n    sources,\n  }),\n  methods: {\n    open(transport: TransportInput) {\n      const { to, from, passengers, order = Infinity } = transport\n      if (!to || !from || !passengers) return\n\n      const newTransport = {\n        to,\n        from,\n        passengers: freeze<object>(passengers),\n        order,\n      } as Transport\n      const keys = Object.keys(this.transports)\n\n      if (keys.indexOf(to) === -1) {\n        Vue.set(this.transports, to, [])\n      }\n\n      const currentIndex = this.$_getTransportIndex(newTransport)\n      // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n      const newTransports = this.transports[to].slice(0)\n      if (currentIndex === -1) {\n        newTransports.push(newTransport)\n      } else {\n        newTransports[currentIndex] = newTransport\n      }\n\n      this.transports[to] = stableSort<Transport>(\n        newTransports,\n        (a: Transport, b: Transport) => a.order - b.order\n      )\n    },\n\n    close(transport: TransportVector, force = false) {\n      const { to, from } = transport\n      if (!to || !from) return\n      if (!this.transports[to]) {\n        return\n      }\n\n      if (force) {\n        this.transports[to] = []\n      } else {\n        const index = this.$_getTransportIndex(transport)\n        if (index >= 0) {\n          // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n          const newTransports = this.transports[to].slice(0)\n          newTransports.splice(index, 1)\n          this.transports[to] = newTransports\n        }\n      }\n    },\n    registerTarget(target: string, vm: Vue, force?: boolean): void {\n      if (!force && this.targets[target]) {\n        console.warn(`[portal-vue]: Target ${target} already exists`)\n      }\n      this.$set(this.targets, target, Object.freeze([vm]))\n    },\n    unregisterTarget(target: string) {\n      this.$delete(this.targets, target)\n    },\n    registerSource(source: string, vm: Vue, force?: boolean): void {\n      if (!force && this.sources[source]) {\n        console.warn(`[portal-vue]: source ${source} already exists`)\n      }\n      this.$set(this.sources, source, Object.freeze([vm]))\n    },\n    unregisterSource(source: string) {\n      this.$delete(this.sources, source)\n    },\n    hasTarget(to: string) {\n      return !!this.targets[to] && this.targets[to][0]\n    },\n    hasSource(to: string) {\n      return !!this.sources[to] && this.sources[to][0]\n    },\n\n    // Internal\n    $_getTransportIndex({ to, from }: TransportVector): number {\n      for (const i in this.transports[to]) {\n        if (this.transports[to][i].from === from) {\n          return +i\n        }\n      }\n      return -1\n    },\n  },\n})\n\nconst wormhole = new Wormhole(transports)\nexport { wormhole }\n","import Vue from 'vue'\nimport { VNode } from 'vue'\nimport { TransportInput, TransportVector } from '../types'\nimport { wormhole } from './wormhole'\n\nlet _id = 1\n\nexport default Vue.extend({\n  name: 'portal',\n  props: {\n    disabled: { type: Boolean },\n    name: { type: String, default: (): object => String(_id++) as any },\n    order: { type: Number, default: 0 },\n    slim: { type: Boolean },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'DIV' },\n    to: {\n      type: String,\n      default: (): object =>\n        String(Math.round(Math.random() * 10000000)) as any,\n    },\n  },\n  created() {\n    if (wormhole.hasSource(this.name)) {\n      console.warn(`\n      [portal-vue] - There already exists another <Portal> with name '${\n        this.name\n      }'.\n      That can lead to unpredictable behaviour and should be avoided.\n      `)\n    }\n    wormhole.registerSource(this.name, this)\n  },\n  mounted() {\n    if (!this.disabled) {\n      this.sendUpdate()\n    }\n  },\n\n  updated() {\n    if (this.disabled) {\n      this.clear()\n    } else {\n      this.sendUpdate()\n    }\n  },\n\n  beforeDestroy() {\n    wormhole.unregisterSource(this.name)\n    this.clear()\n  },\n  watch: {\n    to(newValue: string, oldValue: string): void {\n      oldValue && oldValue !== newValue && this.clear(oldValue)\n      this.sendUpdate()\n    },\n  },\n\n  methods: {\n    clear(target?: string) {\n      const closer: TransportVector = {\n        from: this.name,\n        to: target || this.to,\n      }\n      wormhole.close(closer)\n    },\n    normalizeSlots(): Function[] | VNode[] {\n      return this.$scopedSlots.default\n        ? [this.$scopedSlots.default]\n        : this.$slots.default\n    },\n    normalizeOwnChildren(children: VNode[] | Function): VNode[] {\n      return typeof children === 'function'\n        ? children(this.slotProps)\n        : children\n    },\n    sendUpdate() {\n      const slotContent = this.normalizeSlots()\n      if (slotContent) {\n        const transport: TransportInput = {\n          from: this.name,\n          to: this.to,\n          passengers: [...slotContent],\n          order: this.order,\n        }\n        wormhole.open(transport)\n      } else {\n        this.clear()\n      }\n    },\n  },\n\n  render(h): VNode {\n    const children: VNode[] | Function =\n      this.$slots.default || this.$scopedSlots.default || []\n    const Tag = this.tag\n    if (children.length && this.disabled) {\n      return children.length <= 1 && this.slim ? (\n        this.normalizeOwnChildren(children)[0]\n      ) : (\n        <Tag>{this.normalizeOwnChildren(children)}</Tag>\n      )\n    } else {\n      return this.slim\n        ? h()\n        : h(Tag, {\n            class: { 'v-portal': true },\n            style: { display: 'none' },\n            key: 'v-portal-placeholder',\n          })\n    }\n  },\n})\n","import Vue from 'vue'\nimport { VNode, PropOptions } from 'vue'\nimport { combinePassengers } from '@/utils'\nimport { Transport, PropWithComponent } from '../types'\n\nimport { wormhole } from '@/components/wormhole'\n\nexport default Vue.extend({\n  name: 'portalTarget',\n  props: {\n    multiple: { type: Boolean, default: false },\n    name: { type: String, required: true },\n    slim: { type: Boolean, default: false },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'div' },\n    transition: { type: [String, Object, Function] } as PropOptions<\n      PropWithComponent\n    >,\n  },\n  data() {\n    return {\n      transports: wormhole.transports,\n      firstRender: true,\n    }\n  },\n  created() {\n    if (wormhole.hasTarget(this.name)) {\n      console.warn(`\n      [portal-vue] - There already exists another <PortalTarget> with name '${\n        this.name\n      }'.\n      That can lead to unpredictable behaviour and should be avoided.\n      `)\n    }\n    wormhole.registerTarget(this.name, this)\n  },\n  watch: {\n    ownTransports() {\n      this.$emit('change', this.children().length > 1)\n    },\n    name(newVal, oldVal) {\n      /**\n       * TODO\n       * This should warn as well ...\n       */\n      wormhole.unregisterTarget(oldVal)\n      wormhole.registerTarget(newVal, this)\n    },\n  },\n  mounted() {\n    this.$nextTick(() => {\n      if (this.transition) {\n        // only when we have a transition, because it causes a re-render\n        this.firstRender = false\n      }\n    })\n  },\n  beforeDestroy() {\n    wormhole.unregisterTarget(this.name)\n  },\n\n  computed: {\n    ownTransports(): Transport[] {\n      const transports: Transport[] = this.transports[this.name] || []\n      if (this.multiple) {\n        return transports\n      }\n      return transports.length === 0 ? [] : [transports[transports.length - 1]]\n    },\n    passengers(): VNode[] {\n      return combinePassengers(this.ownTransports, this.slotProps)\n    },\n  },\n\n  methods: {\n    // can't be a computed prop because it has to \"react\" to $slot changes.\n    children(): VNode[] {\n      return this.passengers.length !== 0\n        ? this.passengers\n        : this.$scopedSlots.default\n        ? (this.$scopedSlots.default(this.slotProps) as VNode[])\n        : this.$slots.default || []\n    },\n    // can't be a computed prop because it has to \"react\" to this.children().\n    noWrapper() {\n      const noWrapper = this.slim\n      if (noWrapper && this.children().length > 1) {\n        console.warn(\n          '[portal-vue]: PortalTarget with `slim` option received more than one child element.'\n        )\n      }\n      return noWrapper\n    },\n  },\n  render(h): VNode {\n    const noWrapper = this.noWrapper()\n    const children = this.children()\n    const { transition } = this\n    const Transition =\n      typeof transition === 'string'\n        ? this.slim\n          ? 'transition'\n          : 'transition-group'\n        : transition\n    const Tag = this.tag\n\n    if (Transition) {\n      return h(\n        Transition,\n        {\n          props: {\n            name: typeof transition === 'string' ? transition : undefined,\n            tag: !!this.slim && this.tag,\n          },\n          class: 'vue-portal-target',\n        },\n        children\n      )\n    }\n\n    return noWrapper\n      ? children[0]\n      : this.slim\n      ? h()\n      : h(\n          Tag,\n          {\n            class: { 'vue-portal-target': true },\n          },\n\n          children\n        )\n  },\n})\n","import Vue from 'vue'\nimport { VNode, VueConstructor, PropOptions } from 'vue'\nimport Portal from './portal'\nimport PortalTarget from './portal-target'\nimport { wormhole } from './wormhole'\nimport { pick } from '@/utils'\n\nimport { PropWithComponent } from '@/types'\n\nlet _id = 0\n\nexport type withPortalTarget = VueConstructor<\n  Vue & {\n    portalTarget: any\n  }\n>\n\nconst portalProps = [\n  'disabled',\n  'name',\n  'order',\n  'slim',\n  'slotProps',\n  'tag',\n  'to',\n]\n\nconst targetProps = ['multiple', 'transition']\n\nexport default (Vue as withPortalTarget).extend({\n  name: 'MountingPortal',\n  inheritAttrs: false,\n  props: {\n    append: { type: [Boolean, String] },\n    bail: {\n      type: Boolean,\n    },\n    mountTo: { type: String, required: true },\n\n    // Portal\n    disabled: { type: Boolean },\n    // name for the portal\n    name: {\n      type: String,\n      default: (): object => ('mounted_' + String(_id++)) as any,\n    },\n    order: { type: Number, default: 0 },\n    slim: { type: Boolean },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'DIV' },\n    // name for the target\n    to: {\n      type: String,\n      default: (): object =>\n        String(Math.round(Math.random() * 10000000)) as any,\n    },\n\n    // Target\n    multiple: { type: Boolean, default: false },\n    targetSlotProps: { type: Object, default: () => ({}) },\n    targetTag: { type: String, default: 'div' },\n    transition: { type: [String, Object, Function] } as PropOptions<\n      PropWithComponent\n    >,\n    transitionGroup: { type: Boolean },\n  },\n  created() {\n    if (typeof document === 'undefined') return\n    let el: HTMLElement | null = document.querySelector(this.mountTo)\n\n    if (!el) {\n      console.error(\n        `[portal-vue]: Mount Point '${this.mountTo}' not found in document`\n      )\n      return\n    }\n\n    const props = this.$props\n\n    // Target already exists\n    if (wormhole.targets[props.name]) {\n      if (props.bail) {\n        console.warn(`[portal-vue]: Target ${props.name} is already mounted.\n        Aborting because 'bail: true' is set`)\n      } else {\n        this.portalTarget = wormhole.targets[props.name]\n      }\n      return\n    }\n\n    const { append } = props\n    if (append) {\n      const type = typeof append === 'string' ? append : 'DIV'\n      const mountEl = document.createElement(type)\n      el.appendChild(mountEl)\n      el = mountEl\n    }\n\n    // get props for target from $props\n    // we have to rename a few of them\n    const _props = pick(this.$props, targetProps)\n    _props.tag = this.targetTag\n    _props.slotSprop = this.targetSlotProps\n    _props.name = this.to\n\n    this.portalTarget = new PortalTarget({\n      el,\n      // parent: this,\n      propsData: _props,\n    })\n  },\n\n  beforeDestroy() {\n    const target = this.portalTarget\n    if (this.append) {\n      const el = target.$el\n      el.parentNode.removeChild(el)\n    }\n    target.$destroy()\n  },\n\n  render(h): VNode {\n    if (!this.portalTarget) {\n      console.warn(\"[portal-vue] Target wasn't mounted\")\n      return h()\n    }\n\n    // if there's no \"manual\" scoped slot, so we create a <Portal> ourselves\n    if (!this.$scopedSlots.manual) {\n      const props = pick(this.$props, portalProps)\n      return h(\n        Portal,\n        {\n          props: props,\n          attrs: this.$attrs,\n          on: this.$listeners,\n          scopedSlots: this.$scopedSlots,\n        },\n        this.$slots.default\n      )\n    }\n\n    // else, we render the scoped slot\n    let content: VNode = (this.$scopedSlots.manual({\n      to: this.to,\n    }) as unknown) as VNode\n\n    // if user used <template> for the scoped slot\n    // content will be an array\n    if (Array.isArray(content)) {\n      content = content[0]\n    }\n\n    if (!content) return h()\n\n    return content\n  },\n})\n","import Vue from 'vue'\nimport { VueConstructor, PluginFunction } from 'vue'\nimport Portal from '@/components/portal'\nimport PortalTarget from '@/components/portal-target'\nimport MountingPortal from '@/components/mounting-portal'\nimport { wormhole as Wormhole } from '@/components/wormhole'\n\ndeclare global {\n  interface Window {\n    Vue: VueConstructor\n    ROLLUP_BUILD_MODE: string\n  }\n}\n\ninterface PluginOptions {\n  portalName?: string\n  portalTargetName?: string\n  MountingPortalName?: string\n}\n\nfunction install(Vue: VueConstructor, options: PluginOptions = {}) {\n  Vue.component(options.portalName || 'Portal', Portal)\n  Vue.component(options.portalTargetName || 'PortalTarget', PortalTarget)\n  Vue.component(options.MountingPortalName || 'MountingPortal', MountingPortal)\n}\nif (\n  window.ROLLUP_BUILD_MODE === 'umd' &&\n  typeof window !== 'undefined' &&\n  window.Vue &&\n  window.Vue === Vue\n) {\n  window.Vue.use({ install: install })\n}\n\nexport default {\n  install,\n}\n\nexport { Portal, PortalTarget, MountingPortal, Wormhole }\n"],"names":["freeze","item","Array","isArray","Object","combinePassengers","transports","slotProps","reduce","passengers","transport","temp","newPassengers","concat","stableSort","array","compareFn","map","v","idx","sort","a","b","c","pick","obj","keys","acc","key","hasOwnProperty","targets","sources","Wormhole","Vue","extend","data","methods","open","to","from","order","Infinity","newTransport","indexOf","set","currentIndex","$_getTransportIndex","newTransports","slice","push","close","force","index","splice","registerTarget","target","vm","console","warn","$set","unregisterTarget","$delete","registerSource","source","unregisterSource","hasTarget","hasSource","i","wormhole","_id","name","props","disabled","type","Boolean","String","default","Number","slim","tag","Math","round","random","created","mounted","sendUpdate","updated","clear","beforeDestroy","watch","newValue","oldValue","closer","normalizeSlots","$scopedSlots","$slots","normalizeOwnChildren","children","slotContent","render","h","Tag","length","class","style","display","multiple","required","transition","Function","firstRender","ownTransports","$emit","newVal","oldVal","$nextTick","computed","noWrapper","Transition","undefined","portalProps","targetProps","inheritAttrs","append","bail","mountTo","targetSlotProps","targetTag","transitionGroup","document","el","querySelector","error","$props","portalTarget","mountEl","createElement","appendChild","_props","slotSprop","PortalTarget","propsData","$el","parentNode","removeChild","$destroy","manual","Portal","attrs","$attrs","on","$listeners","scopedSlots","content","install","options","component","portalName","portalTargetName","MountingPortalName","MountingPortal","window","use"],"mappings":"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"}