{"version":3,"file":"portal-vue.common.js","sources":["../src/utils/index.ts","../src/components/wormhole.ts","../src/components/portal.tsx","../src/components/portal-target.tsx","../src/components/portal-target-provider.tsx","../src/index.ts"],"sourcesContent":["import { VNode } from 'vue'\nimport { Transport } from '../types'\n\nexport function freeze<R>(item: R[]): ReadonlyArray<R> {\n  if (Array.isArray(item) || typeof item === 'object') {\n    return Object.freeze(item)\n  }\n  return item\n}\n\nexport function combinePassengers(\n  transports: Transport[],\n  slotProps = {}\n): Array<VNode> {\n  return transports.reduce(\n    (passengers, transport) => {\n      const temp = transport.passengers[0]\n      const newPassengers =\n        typeof temp === 'function'\n          ? (temp(slotProps) as VNode[])\n          : (transport.passengers as VNode[])\n      return passengers.concat(newPassengers)\n    },\n    [] as Array<VNode>\n  )\n}\n\nexport function stableSort<T>(array: T[], compareFn: Function) {\n  return array\n    .map((v: T, idx: number) => {\n      return [idx, v] as [number, T]\n    })\n    .sort(function(a, b) {\n      return compareFn(a[1], b[1]) || a[0] - b[0]\n    })\n    .map(c => c[1])\n}\n","import Vue from 'vue'\nimport { freeze, stableSort } from '../utils'\nimport {\n  Transports,\n  Transport,\n  TransportInput,\n  TransportVector,\n  StringBoolMap,\n} from '@/types'\n\nconst transports: Transports = {}\nconst targets: StringBoolMap = {}\nconst sources: StringBoolMap = {}\n\nexport const Wormhole = Vue.extend({\n  data: () => ({\n    transports,\n    targets,\n    sources,\n  }),\n  methods: {\n    open(transport: TransportInput) {\n      const { to, from, passengers, order = Infinity } = transport\n      if (!to || !from || !passengers) return\n\n      const newTransport = {\n        to,\n        from,\n        passengers: freeze<object>(passengers),\n        order,\n      } as Transport\n      const keys = Object.keys(this.transports)\n\n      if (keys.indexOf(to) === -1) {\n        Vue.set(this.transports, to, [])\n      }\n\n      const currentIndex = this.$_getTransportIndex(newTransport)\n      // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n      const newTransports = this.transports[to].slice(0)\n      if (currentIndex === -1) {\n        newTransports.push(newTransport)\n      } else {\n        newTransports[currentIndex] = newTransport\n      }\n\n      this.transports[to] = stableSort<Transport>(\n        newTransports,\n        (a: Transport, b: Transport) => a.order - b.order\n      )\n    },\n\n    close(transport: TransportVector, force = false) {\n      const { to, from } = transport\n      if (!to || !from) return\n      if (!this.transports[to]) {\n        return\n      }\n\n      if (force) {\n        this.transports[to] = []\n      } else {\n        const index = this.$_getTransportIndex(transport)\n        if (index >= 0) {\n          // Copying the array here so that the PortalTarget change event will actually contain two distinct arrays\n          const newTransports = this.transports[to].slice(0)\n          newTransports.splice(index, 1)\n          this.transports[to] = newTransports\n        }\n      }\n    },\n    registerTarget(target: string, force?: boolean): void {\n      if (!force && this.targets[target]) {\n        console.warn(`[portal-vue]: Target ${target} already exists`)\n      }\n      this.$set(this.targets, target, true)\n    },\n    unregisterTarget(target: string) {\n      this.$delete(this.targets, target)\n    },\n    registerSource(source: string, force?: boolean): void {\n      if (!force && this.sources[source]) {\n        console.warn(`[portal-vue]: source ${source} already exists`)\n      }\n      this.$set(this.sources, source, true)\n    },\n    unregisterSource(source: string) {\n      this.$delete(this.sources, source)\n    },\n    hasTarget(to: string) {\n      return !!this.targets[to]\n    },\n    hasSource(to: string) {\n      return !!this.sources[to]\n    },\n\n    // Internal\n    $_getTransportIndex({ to, from }: TransportVector): number {\n      for (const i in this.transports[to]) {\n        if (this.transports[to][i].from === from) {\n          return +i\n        }\n      }\n      return -1\n    },\n  },\n})\n\nconst wormhole = new Wormhole(transports)\nexport { wormhole }\n","import Vue from 'vue'\nimport { VNode } from 'vue'\nimport { TransportInput, TransportVector } from '../types'\nimport { wormhole } from './wormhole'\n\nlet _id = 1\n\nexport default Vue.extend({\n  name: 'portal',\n  props: {\n    disabled: { type: Boolean },\n    name: { type: String, default: (): object => String(_id++) as any },\n    order: { type: Number, default: 0 },\n    slim: { type: Boolean },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'DIV' },\n    to: {\n      type: String,\n      default: (): object =>\n        String(Math.round(Math.random() * 10000000)) as any,\n    },\n  },\n  created() {\n    if (wormhole.hasSource(this.name)) {\n      console.warn(`\n      [portal-vue] - There already exists another <Portal> with name '${\n        this.name\n      }'.\n      That can lead to unpredictable behaviour and should be avoided.\n      `)\n    }\n    wormhole.registerSource(this.name)\n  },\n  mounted() {\n    if (!this.disabled) {\n      this.sendUpdate()\n    }\n  },\n\n  updated() {\n    if (this.disabled) {\n      this.clear()\n    } else {\n      this.sendUpdate()\n    }\n  },\n\n  beforeDestroy() {\n    wormhole.unregisterSource(this.name)\n    this.clear()\n  },\n  watch: {\n    to(newValue: string, oldValue: string): void {\n      oldValue && oldValue !== newValue && this.clear(oldValue)\n      this.sendUpdate()\n    },\n  },\n\n  methods: {\n    clear(target?: string) {\n      const closer: TransportVector = {\n        from: this.name,\n        to: target || this.to,\n      }\n      wormhole.close(closer)\n    },\n    normalizeSlots(): Function[] | VNode[] {\n      return this.$scopedSlots.default\n        ? [this.$scopedSlots.default]\n        : this.$slots.default\n    },\n    normalizeOwnChildren(children: VNode[] | Function): VNode[] {\n      return typeof children === 'function'\n        ? children(this.slotProps)\n        : children\n    },\n    sendUpdate() {\n      const slotContent = this.normalizeSlots()\n      if (slotContent) {\n        const transport: TransportInput = {\n          from: this.name,\n          to: this.to,\n          passengers: [...slotContent],\n          order: this.order,\n        }\n        wormhole.open(transport)\n      } else {\n        this.clear()\n      }\n    },\n  },\n\n  render(h): VNode {\n    const children: VNode[] | Function =\n      this.$slots.default || this.$scopedSlots.default || []\n    const Tag = this.tag\n    if (children.length && this.disabled) {\n      return children.length <= 1 && this.slim ? (\n        this.normalizeOwnChildren(children)[0]\n      ) : (\n        <Tag>{this.normalizeOwnChildren(children)}</Tag>\n      )\n    } else {\n      return this.slim\n        ? h()\n        : h(Tag, {\n            class: { 'v-portal': true },\n            style: { display: 'none' },\n            key: 'v-portal-placeholder',\n          })\n    }\n  },\n})\n","import Vue from 'vue'\nimport { VNode, VueConstructor, ComponentOptions, PropOptions } from 'vue'\nimport { combinePassengers } from '@/utils'\nimport { Transport } from '../types'\n\nimport { wormhole } from '@/components/wormhole'\n\nexport type PropWithComponent =\n  | VueConstructor<Vue>\n  | ComponentOptions<Vue>\n  | string\n\nexport default Vue.extend({\n  name: 'portalTarget',\n  props: {\n    multiple: { type: Boolean, default: false },\n    name: { type: String, required: true },\n    slim: { type: Boolean, default: false },\n    slotProps: { type: Object, default: () => ({}) },\n    tag: { type: String, default: 'div' },\n    transition: { type: [String, Object, Function] } as PropOptions<\n      PropWithComponent\n    >,\n  },\n  data() {\n    return {\n      transports: wormhole.transports,\n      firstRender: true,\n    }\n  },\n  created() {\n    if (wormhole.hasTarget(this.name)) {\n      console.warn(`\n      [portal-vue] - There already exists another <PortalTarget> with name '${\n        this.name\n      }'.\n      That can lead to unpredictable behaviour and should be avoided.\n      `)\n    }\n    wormhole.registerTarget(this.name)\n  },\n  watch: {\n    ownTransports() {\n      this.$emit('change', this.children().length > 1)\n    },\n    name(newVal, oldVal) {\n      /**\n       * TODO\n       * This should warn as well ...\n       */\n      wormhole.unregisterTarget(oldVal)\n      wormhole.registerTarget(newVal)\n    },\n  },\n  mounted() {\n    this.$nextTick(() => {\n      if (this.transition) {\n        // only when we have a transition, because it causes a re-render\n        this.firstRender = false\n      }\n    })\n  },\n  beforeDestroy() {\n    wormhole.unregisterTarget(this.name)\n  },\n\n  computed: {\n    ownTransports(): Transport[] {\n      const transports: Transport[] = this.transports[this.name] || []\n      if (this.multiple) {\n        return transports\n      }\n      return transports.length === 0 ? [] : [transports[transports.length - 1]]\n    },\n    passengers(): VNode[] {\n      return combinePassengers(this.ownTransports, this.slotProps)\n    },\n    withTransition(): boolean {\n      return !!this.transition\n    },\n  },\n\n  methods: {\n    // can't be a computed prop because it has to \"react\" to $slot changes.\n    children(): VNode[] {\n      return this.passengers.length !== 0\n        ? this.passengers\n        : this.$scopedSlots.default\n        ? (this.$scopedSlots.default(this.slotProps) as VNode[])\n        : this.$slots.default || []\n    },\n    // can't be a computed prop because it has to \"react\" to this.children().\n    noWrapper() {\n      const noWrapper = this.slim\n      if (noWrapper && this.children().length > 1) {\n        console.warn(\n          '[portal-vue]: PortalTarget with `slim` option received more than one child element.'\n        )\n      }\n      return noWrapper\n    },\n  },\n  render(h): VNode {\n    const noWrapper = this.noWrapper()\n    const children = this.children()\n    const { transition } = this\n    const Transition =\n      typeof transition === 'string' ? 'transition' : transition\n    const Tag = this.tag\n\n    if (this.withTransition) {\n      return h(\n        Transition,\n        {\n          props:\n            typeof transition === 'string' ? { name: transition } : undefined,\n          class: 'vue-portal-target',\n        },\n        children\n      )\n    }\n\n    return noWrapper\n      ? children[0]\n      : this.slim\n      ? h()\n      : h(\n          Tag,\n          {\n            class: { 'vue-portal-target': true },\n          },\n\n          children\n        )\n  },\n})\n","import Vue from 'vue'\nimport { VueConstructor } from 'vue'\nimport { VNode } from 'vue'\nimport Portal from './portal'\nimport PortalTarget from './portal-target'\nimport { wormhole } from './wormhole'\n\nlet _id = 0\n\nexport type withPortalTarget = VueConstructor<\n  Vue & {\n    portalTarget: any\n  }\n>\n\nexport default (Vue as withPortalTarget).extend({\n  name: 'PortalTargetProvider',\n  inheritAttrs: false,\n  props: {\n    append: { type: [Boolean, String] },\n    force: {\n      type: Boolean,\n    },\n    mountTo: { type: String, required: true },\n    name: {\n      type: String,\n      default: (): object => `Target-${String(_id++)}` as any,\n    },\n  },\n  data() {\n    return {\n      props: { ...this.$props },\n    }\n  },\n  created() {\n    let el: HTMLElement | null = document.querySelector(this.mountTo)\n\n    if (!el) {\n      console.error(\n        `[portal-vue]: Mount Point '${this.mountTo}' not found in document`\n      )\n      return\n    }\n\n    const props = this.props\n\n    // Target alredy exists\n    if (wormhole.targets[props.name]) {\n      if (!props.force) {\n        console.info(`[portal-vue]: Target ${props.name} is already mounted.\n        Make sure it's the right one`)\n\n        return\n      }\n    }\n\n    const { append } = props\n    if (append) {\n      const type = typeof append === 'string' ? append : 'DIV'\n      const mountEl = document.createElement(type)\n      el.appendChild(mountEl)\n      el = mountEl\n    }\n\n    this.portalTarget = new PortalTarget({\n      el,\n      parent: this,\n      propsData: {\n        name: props.name,\n        ...this.$attrs,\n      },\n    })\n  },\n  beforeDestroy() {\n    const target = this.portalTarget\n    if (this.props.append) {\n      const el = target.$el\n      el.parentNode.removeChild(el)\n    }\n    target.$destroy()\n  },\n  render(h): VNode {\n    const props = this.props\n\n    if (!this.portalTarget) {\n      console.warn(\"[portal-vue] Target wasn't mounted\")\n      return h()\n    }\n    if (!this.$scopedSlots.default) {\n      console.error(\n        `[portal-vue]: <PortalTargetProvider> expects to be passed a scoped slot.`\n      )\n      return h()\n    }\n    debugger\n    let content: VNode = (this.$scopedSlots.default({\n      to: props.name,\n    }) as unknown) as VNode\n\n    // if user used <template> for the scoped slot\n    // content will be an array\n    if (Array.isArray(content)) {\n      content = content[0]\n    }\n    debugger\n    if (!content) return h()\n\n    if (content.componentOptions && content.componentOptions.Ctor !== Portal) {\n      console.error(\n        `[portal-vue]: First and only child element of <PortalTargetrovider> has to be an instance of <Portal>`\n      )\n      return h()\n    }\n    return content\n  },\n})\n","import Vue from 'vue'\nimport { VueConstructor, PluginFunction } from 'vue'\nimport Portal from '@/components/portal'\nimport PortalTarget from '@/components/portal-target'\nimport PortalTargetProvider from '@/components/portal-target-provider'\nimport { wormhole as Wormhole } from '@/components/wormhole'\n\ndeclare global {\n  interface Window {\n    Vue: VueConstructor\n    ROLLUP_BUILD_MODE: string\n  }\n}\n\ninterface PluginOptions {\n  portalName?: string\n  portalTargetName?: string\n  portalTargetProviderName?: string\n}\n\nfunction install(Vue: VueConstructor, options: PluginOptions = {}) {\n  Vue.component(options.portalName || 'Portal', Portal)\n  Vue.component(options.portalTargetName || 'PortalTarget', PortalTarget)\n  Vue.component(\n    options.portalTargetProviderName || 'PortalTargetProvider',\n    PortalTargetProvider\n  )\n}\nif (\n  window.ROLLUP_BUILD_MODE === 'umd' &&\n  typeof window !== 'undefined' &&\n  window.Vue &&\n  window.Vue === Vue\n) {\n  window.Vue.use({ install: install })\n}\n\nexport default {\n  install,\n}\n\nexport { Portal, PortalTarget, PortalTargetProvider, Wormhole }\n"],"names":["freeze","item","Array","isArray","Object","combinePassengers","transports","slotProps","reduce","passengers","transport","temp","newPassengers","concat","stableSort","array","compareFn","map","v","idx","sort","a","b","c","targets","sources","Wormhole","Vue","extend","data","methods","open","to","from","order","Infinity","newTransport","keys","indexOf","set","currentIndex","$_getTransportIndex","newTransports","slice","push","close","force","index","splice","registerTarget","target","console","warn","$set","unregisterTarget","$delete","registerSource","source","unregisterSource","hasTarget","hasSource","i","wormhole","_id","name","props","disabled","type","Boolean","String","default","Number","slim","tag","Math","round","random","created","mounted","sendUpdate","updated","clear","beforeDestroy","watch","newValue","oldValue","closer","normalizeSlots","$scopedSlots","$slots","normalizeOwnChildren","children","slotContent","render","h","Tag","length","class","style","display","key","multiple","required","transition","Function","firstRender","ownTransports","$emit","newVal","oldVal","$nextTick","computed","withTransition","noWrapper","Transition","undefined","inheritAttrs","append","mountTo","$props","el","document","querySelector","error","info","mountEl","createElement","appendChild","portalTarget","PortalTarget","parent","propsData","$attrs","$el","parentNode","removeChild","$destroy","content","componentOptions","Ctor","Portal","install","options","component","portalName","portalTargetName","portalTargetProviderName","PortalTargetProvider"],"mappings":"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"}