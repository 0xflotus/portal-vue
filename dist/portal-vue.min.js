!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("vue")):"function"==typeof define&&define.amd?define(["vue"],e):t.PortalVue=e(t.Vue)}(this,function(t){"use strict";function e(t){for(var e=t.hasAttributes()?t.attributes:[],n={},r=0;r<e.length;r++){var o=e[r];o.value&&(n[o.name]=""===o.value||o.value)}return n}function n(t){return Array.isArray(t)||"object"===("undefined"==typeof t?"undefined":i(t))?Object.freeze(t):t}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.component(e.portalName||"portal",p),t.component(e.portalTargetName||"portal-target",d)}t="default"in t?t.default:t;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s={},l=function(){function e(t){r(this,e),this.routes=t,this.clearQueue=[],this.updateQueue=[],this.runScheduled=!1}return u(e,[{key:"send",value:function(t,e){var n={name:t,passengers:e};this.updateQueue.push(n),this._scheduleRun()}},{key:"close",value:function(t){var e={name:t};this.clearQueue.push(e),this._scheduleRun()}},{key:"_scheduleRun",value:function(){this.runScheduled||(this.runScheduled=!0,t.nextTick(this._runQueue.bind(this)))}},{key:"_runQueue",value:function(){var e=this,r=Object.keys(this.routes);this.clearQueue.forEach(function(t){var n=t.name;r.includes(n)&&(e.routes[n]=void 0)}),this.clearQueue=[],this.updateQueue.forEach(function(o){var a=o.name,i=o.passengers;r.includes(a)?e.routes[a]=n(i):t.set(e.routes,a,n(i))}),this.updateQueue=[],this.runScheduled=!1}}]),e}(),c=new l(s),d={abstract:!0,name:"portalTarget",props:{attributes:{type:Object},name:{type:String,required:!0},slim:{type:Boolean,default:!1},tag:{type:String,default:"div"}},data:function(){return{routes:s}},mounted:function(){this.updateAttributes()},updated:function(){this.updateAttributes()},beforeDestroy:function(){this.$el.innerHTML=""},methods:{updateAttributes:function(){if(this.attributes){var t=this.attributes,e=this.$el;t.class&&(t.class.trim().split(" ").forEach(function(t){e.classList.add(t)}),delete t.class);for(var n=Object.keys(t),r=0;r<n.length;r++)e.setAttribute(n[r],t[n[r]])}}},computed:{passengers:function(){return this.routes[this.name]||null},renderSlim:function(){var t=this.passengers||[];return 1===t.length&&!this.attributes&&this.slim}},render:function(t){var e=this.passengers||[];return this.renderSlim?e[0]:t(this.tag,{class:{"vue-portal-target":!0}},e)}},f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},h="undefined"!=typeof window,p={abstract:!0,name:"portal",props:{disabled:{type:Boolean,default:!1},slim:{type:Boolean,default:!1},tag:{type:[String],default:"DIV"},targetEl:{type:h?[String,HTMLElement]:String},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}}},mounted:function(){this.targetEl&&this.mountToTarget(),this.disabled||this.sendUpdate()},updated:function(){this.disabled?this.clear():this.sendUpdate()},beforeDestroy:function(){this.clear(),this.mountedComp&&this.mountedComp.$destroy()},watch:{to:function(t,e){e&&this.clear(e),this.sendUpdate()},targetEl:function(t,e){this.mountToTarget()}},methods:{sendUpdate:function(){this.to?this.$slots.default&&c.send(this.to,[].concat(o(this.$slots.default))):this.to||this.targetEl||console.warn("[vue-portal]: You have to define a targte via the `to` prop.")},clear:function(t){c.close(t||this.to)},mountToTarget:function(){var n=void 0,r=this.targetEl;if("string"==typeof r)n=document.querySelector(this.targetEl);else{if(!(r instanceof HTMLElement))return void console.warn("[vue-portal]: value of targetEl must eb of type String or HTMLElement");n=r}var o=e(n);if(n){var a=new t(f({},d,{parent:this,propsData:{name:this.to,tag:n.tagName,attributes:o}}));a.$mount(n),this.mountedComp=a}else console.warn("[vue-portal]: The specified targetEl "+this.targetEl+" was not found")}},render:function(t){var e=this.$slots.default||[];return e.length&&this.disabled?e.length<=1&&this.slim?e[0]:t(this.tag,e):t(this.tag,{class:{"v-portal":!0},style:{display:"none"},key:"v-portal-placeholder"})}};"undefined"!=typeof window&&window.Vue&&window.Vue.use({install:a});var m={install:a,Portal:p,PortalTarget:d};return m});
